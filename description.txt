ssh EBochkov@10.224.151.215

git clone https://Bochkov@github.com/BochkovEK/LordParser.git && \
cd LordParser;
git checkout dev

sudo podman compose -f docker-compose.yml up -d

#venv
pip install virtualenv -i https://pypi.org/simple/
export PATH="/usr/local/bin:$PATH"
virtualenv --system-site-packages -p python ./venv
source ./venv/bin/activate

pip install -r requirements.txt -i https://pypi.org/simple/

# [TEST START] Start create db
python3 db_scheduler.py

# Check DB
sudo podman exec -it movie_postgres psql -U movie_user -d movie_db -c "SELECT * FROM movies LIMIT 5;"

# Clean DB
# 1. Удалить только базу данных
sudo podman exec -it movie_postgres psql -U movie_user -d movie_db -c "DROP DATABASE movie_db;"
# 2. Удалить все таблицы
sudo podman exec -it movie_postgres psql -U movie_user -d movie_db -c "DROP SCHEMA public CASCADE; CREATE SCHEMA public;"

# Запуск scheduler DB
# --------------------
# Скопировать конфиг сервиса
sudo cd ./movie-parser.service ./.service /etc/systemd/system/

# Перезагрузите systemd:
sudo systemctl daemon-reload
Включите автозагрузку:

# Включить сервис:
sudo systemctl enable movie-parser.service

# Запустите сервис:
sudo systemctl start movie-parser.service

# Проверьте статус:
sudo systemctl status movie-parser.service
journalctl -u movie-parser.service -f

# Мониторинг логов:
tail -f /home/kolla/test/parser.log

# Остановить сервис:
sudo systemctl stop movie-parser.service

# Запуск lordfilm Bot
# --------------------
# Скопировать конфиг сервиса
sudo cd ./lordfilm_bot.service /etc/systemd/system/

# Перезагрузить конфигурацию systemd (если вносили изменения)
sudo systemctl daemon-reload

# Запустить бота
sudo systemctl start lordfilm_bot

# Остановить бота
sudo systemctl stop lordfilm_bot

# Перезапустить бота
sudo systemctl restart lordfilm_bot

# Проверить статус бота
sudo systemctl status lordfilm_bot

# Включить автозагрузку при старте системы
sudo systemctl enable lordfilm_bot

# Посмотреть логи в реальном времени
sudo journalctl -u lordfilm_bot -f

# Посмотреть последние логи
sudo journalctl -u lordfilm_bot -n 50

# Посмотреть логи с определенного времени
sudo journalctl -u lordfilm_bot --since "2024-01-01 00:00:00"

#------------------------------------------------------
#------------------------------------------------------

# Container
sudo podman run -d --name selenium_chrome -p 4444:4444 --shm-size=2g docker.io/selenium/standalone-chrome:latest
# docker run -d --name selenium_chrome -p 4444:4444 --shm-size=2g selenium/standalone-chrome

sudo podman stop selenium_chrome
sudo podman rm selenium_chrome

# Service
# sudo chown -R kolla:kolla /home/kolla/test
# put in to /etc/systemd/system/lordfilm_bot.service
# sudo systemctl daemon-reload
# sudo systemctl start lordfilm_bot
# sudo systemctl enable lordfilm_bot now

# ------------------------------------------------------
# не раб
sudo podman run -d \
  --name browserless_chrome \
  -p 3000:3000 \
  -e "CONCURRENT=10" \
  -e "TIMEOUT=60000" \
  -e "QUEUED=20" \
  -e "DATA_DIR=/data/profile" \
  -e "TOKEN=6R0W53R135510" \
  -v /home/kolla/test:/data \
  ghcr.io/browserless/chromium:latest

# не раб
sudo podman run -d \
  --name browserless_chrome \
  -p 3000:3000 \
  -e "TIMEOUT=120000" \
  -e "CONCURRENT_SESSIONS=5" \
  browserless/chrome:latest

